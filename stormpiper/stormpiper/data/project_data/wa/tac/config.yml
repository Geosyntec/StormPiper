config_date: "2022-07-14"
pint_unit_registry:
  # all units must be either compatible with `pint` or be defined here.
  - mcg = microgram

api_recognize:
  treatment_facility:
    preprocess:
      - joins:
          - other: met_table
            how: left
            left_on: ref_data_key
            right_on: epoch
            validate: many_to_one
            indicator: True
      - remaps:
          - left: hsg
            right: inf_rate_inhr
            how: left # interpreted as 'right' = mapping['left'] if 'left' exists
            fillna: 1.0e-6
            mapping:
              # TODO: update these for Tacoma
              a: 5.67
              b: 1.42
              c: 0.14
              d: 0.07 # half of c rate
              lined: 1.0e-6

    facility_type:
      bioretention_hrbf_media_with_no_infiltration:
        label: Bioretention with High Rate Media and No Infiltration
        tmnt_performance_facility_type: HRBF
        validation_fallback: NTFacility
        validator: TmntFacility
      bioretention_hrbf_media_with_no_infiltration_simple:
        label: Bioretention with High Rate Media and No Infiltration (simple)
        tmnt_performance_facility_type: HRBF
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      bioretention_hrbf_media_with_partial_infiltration:
        label: Bioretention with High Rate Media and Partial Infiltration
        tmnt_performance_facility_type: HRBF
        validation_fallback: NTFacility
        validator: BioInfFacility
      bioretention_hrbf_media_with_partial_infiltration_simple:
        label: Bioretention with High Rate Media and Partial Infiltration (simple)
        tmnt_performance_facility_type: HRBF
        validation_fallback: NTFacility
        validator: SimpleFacility
      bioretention_with_full_infiltration:
        label: Bioretention with Full Infiltration
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: RetentionFacility
      bioretention_with_full_infiltration_simple:
        label: Bioretention with Full Infiltration (simple)
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: SimpleRetFacility
      bioretention_with_no_infiltration:
        label: Bioretention with No Infiltration
        tmnt_performance_facility_type: BR
        validation_fallback: NTFacility
        validator: TmntFacility
      bioretention_with_no_infiltration_simple:
        label: Bioretention with No Infiltration (simple)
        tmnt_performance_facility_type: BR
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      bioretention_with_partial_infiltration:
        label: Bioretention with Partial Infiltration
        tmnt_performance_facility_type: BR
        validation_fallback: NTFacility
        validator: BioInfFacility
      bioretention_with_partial_infiltration_simple:
        label: Bioretention with Partial Infiltration (simple)
        tmnt_performance_facility_type: BR
        validation_fallback: NTFacility
        validator: SimpleFacility
      cartridge_media_filter:
        label: Cartridge Media Filter
        tmnt_performance_facility_type: HRMF
        validation_fallback: NTFacility
        validator: TmntFacility
      cartridge_media_filter_simple:
        label: Cartridge Media Filter (simple)
        tmnt_performance_facility_type: HRMF
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      detention_pond:
        label: Detention Pond
        tmnt_performance_facility_type: DB
        validation_fallback: NTFacility
        validator: RetAndTmntFacility
      detention_pond_simple:
        label: Detention Pond (simple)
        tmnt_performance_facility_type: DB
        validation_fallback: NTFacility
        validator: SimpleFacility
      dispersion_area:
        label: Dispersion Area
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: RetentionFacility
      dispersion_area_simple:
        label: Dispersion Area (simple)
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: SimpleRetFacility
      dry_extended_detention:
        label: Dry Extended Detention Basin/Tank
        tmnt_performance_facility_type: DB
        validation_fallback: NTFacility
        validator: RetAndTmntFacility
      dry_extended_detention_simple:
        label: Dry Extended Detention Basin/Tank (simple)
        tmnt_performance_facility_type: DB
        validation_fallback: NTFacility
        validator: SimpleFacility
      drywell:
        label: Drywell
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: DryWellFacilityFlowOrVolume
      drywell_simple:
        label: Drywell (simple)
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: SimpleRetFacility
      flow_duration_control_tank:
        label: Flow Duration Control Tank
        tmnt_performance_facility_type: DB
        validation_fallback: NTFacility
        validator: RetAndTmntFacility
      flow_duration_control_tank_simple:
        label: Flow Duration Control Tank (simple)
        tmnt_performance_facility_type: DB
        validation_fallback: NTFacility
        validator: SimpleFacility
      hydrodynamic_separator:
        label: Hydrodynamic Separator
        tmnt_performance_facility_type: HDS
        validation_fallback: NTFacility
        validator: FlowFacility
      hydrodynamic_separator_simple:
        label: Hydrodynamic Separator (simple)
        tmnt_performance_facility_type: HDS
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      infiltration:
        label: Infiltration Basin/Trench
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: RetentionFacility
      infiltration_pond:
        label: Infiltration Pond
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: RetentionFacility
      infiltration_pond_simple:
        label: Infiltration Pond (simple)
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: SimpleRetFacility
      infiltration_simple:
        label: Infiltration Basin/Trench (simple)
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: SimpleRetFacility
      media_filter:
        label: Media Filter High Rate
        tmnt_performance_facility_type: HRMF
        validation_fallback: NTFacility
        validator: TmntFacility
      media_filter_simple:
        label: Media Filter High Rate (simple)
        tmnt_performance_facility_type: HRMF
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      no_treatment:
        label: No Treatment
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: NTFacility
      oil_water_separator:
        label: Oil-Water Separator
        tmnt_performance_facility_type: OGS
        validation_fallback: NTFacility
        validator: FlowFacility
      oil_water_separator_simple:
        label: Oil-Water Separator (simple)
        tmnt_performance_facility_type: OGS
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      pervious_pavement_with_full_infiltration:
        label: Pervious Pavement with Full Infiltration
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: RetentionFacility
      pervious_pavement_with_full_infiltration_simple:
        label: Pervious Pavement with Full Infiltration (simple)
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: SimpleRetFacility
      pervious_pavement_with_partial_infiltration:
        label: Pervious Pavement with Partial Infiltration
        tmnt_performance_facility_type: PP
        validation_fallback: NTFacility
        validator: RetAndTmntFacility
      pervious_pavement_with_partial_infiltration_simple:
        label: Pervious Pavement with Partial Infiltration (simple)
        tmnt_performance_facility_type: PP
        validation_fallback: NTFacility
        validator: SimpleFacility
      sand_filter:
        label: Sand Filter
        tmnt_performance_facility_type: MF
        validation_fallback: NTFacility
        validator: TmntFacility
      sand_filter_simple:
        label: Sand Filter (simple)
        tmnt_performance_facility_type: MF
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      vault:
        label: Vault
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: FlowFacility
      vault_simple:
        label: Vault (simple)
        tmnt_performance_facility_type: ¯\_(ツ)_/¯
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      vegetated_box:
        label: Filterra/Vegetated Box
        tmnt_performance_facility_type: BR
        validation_fallback: NTFacility
        validator: FlowFacility
      vegetated_box_hrbf:
        label: Filterra/Vegetated Box High Rate
        tmnt_performance_facility_type: HRBF
        validation_fallback: NTFacility
        validator: FlowFacility
      vegetated_box_hrbf_simple:
        label: Filterra/Vegetated Box High Rate (simple)
        tmnt_performance_facility_type: HRBF
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      vegetated_box_simple:
        label: Filterra/Vegetated Box (simple)
        tmnt_performance_facility_type: BR
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      vegetated_swale:
        label: Vegetated Swale
        tmnt_performance_facility_type: BS
        validation_fallback: NTFacility
        validator: FlowAndRetFacility
      vegetated_swale_simple:
        label: Vegetated Swale (simple)
        tmnt_performance_facility_type: BS
        validation_fallback: NTFacility
        validator: SimpleFacility
      wet_pond:
        label: Wet Pond
        tmnt_performance_facility_type: RP
        validation_fallback: NTFacility
        validator: PermPoolFacility
      wet_pond_simple:
        label: Wet Pond (simple)
        tmnt_performance_facility_type: RP
        validation_fallback: NTFacility
        validator: SimpleTmntFacility
      wet_vault:
        label: Wet Vault
        tmnt_performance_facility_type: RP
        validation_fallback: NTFacility
        validator: RetAndTmntFacility
      wet_vault_simple:
        label: Wet Vault (simple)
        tmnt_performance_facility_type: RP
        validation_fallback: NTFacility
        validator: SimpleFacility
      wetland_pond:
        label: Wetland Pond
        tmnt_performance_facility_type: WB
        validation_fallback: NTFacility
        validator: PermPoolFacility
      wetland_pond_simple:
        label: Wetland Pond (simple)
        tmnt_performance_facility_type: WB
        validation_fallback: NTFacility
        validator: SimpleTmntFacility

project_reference_data:
  met_table:
    file: nomo_data.json
    volume_nomo:
      x_col: size_fraction
      t_col: ddt_hr
      y_col: capture_fraction
    flow_nomo:
      x_col: intensity_inhr
      t_col: tc_minutes
      y_col: capture_fraction

    nomographs:
      - file_key: volume_nomograph
        type: volume_capture
        constructor: VolumeNomograph
        x_col: size_fraction
        t_col: ddt_hr
        y_col: capture_fraction

      - file_key: flow_nomograph
        type: volume_capture
        constructor: FlowNomograph
        x_col: intensity_inhr
        t_col: tc_minutes
        y_col: capture_fraction

  tmnt_performance_table:
    file: bmp_params_2025.json
    facility_column: bmp
    pollutant_column: pollutant

  # long names and short names must be unique in the config. e.g., cannot have TSS for two tables,
  # you must have a prefix or suffix
  land_surface_emc_table:
    parameters:
      # units must be compatible with the `pint` library
      - long_name: Total Suspended Solids # long_name must match bmp performance parameters
        short_name: TSS # short_name must match EMC pollutant prefix e.g., TSS_conc_mg/l
        concentration_unit: mg/L
        load_unit: lbs
      - long_name: Total Nitrogen
        short_name: TN
        concentration_unit: mg/L
        load_unit: lbs
      - long_name: Total Phosphorus
        short_name: TP
        concentration_unit: mg/L
        load_unit: lbs
      - long_name: Total Zinc
        short_name: TZn
        concentration_unit: ug/L
        load_unit: lbs
      - long_name: Total Copper
        short_name: TCu
        concentration_unit: ug/L
        load_unit: lbs
